<html>
<head>
<script src='https://statics.teams.cdn.office.net/sdk/v1.7.0/js/MicrosoftTeams.min.js'></script>
</head>
<style>
body {
    font-family: sans-serif;
    font-size: 14px;
    color: #484644;
}
.form-line {
    display: flex;
    justify-content: space-between;
    margin: .5rem;
}
.form-line input {
    width: 80%;
}
</style>
    <body>
        <form>
            <div class="form-line">
                <label for="config">Config*</label>
                <input type="text" id="config" onkeyup="save();" onchange="save();" value="config.json">
            </div>

            <div class="form-line">
                <label for="path">Path*</label>
                <input type="text" id="path" onkeyup="save();" onchange="save();" placeholder="e.g. https://contoso.sharepoint.com/sites/IT/Accounts/IT.kdbx">
            </div>

            <div class="form-line">
                <label for="password">Password*</label>
                <input type="text" id="password" onkeyup="save();" onchange="save();" placeholder="Not directly visible to user - should be autogenerated">
            </div>
        </form>

        <script>
            const el = ['config', 'path', 'password'];
            microsoftTeams.initialize(() => {
                microsoftTeams.settings.registerOnSaveHandler((saveEvent) => {
                    const queryString = el
                        .map(key => key + '=' + encodeURIComponent(document.getElementById(key).value))
                        .join('&');

                    microsoftTeams.settings.setSettings({
                        websiteUrl: `${window.location.origin}/?storage=teams&${queryString}`,
                        contentUrl: `${window.location.origin}/?teamsAuth=true&storage=teams&${queryString}`,
                        entityId: 'keeweb',
                        suggestedDisplayName: 'Accounts'
                    });
                    saveEvent.notifySuccess();
                });
            });
            const save = () => {
                let valid = el.every(key => !!document.getElementById(key).value);
                microsoftTeams.settings.setValidityState(valid);
            };
        </script>
    </body>
</html>
